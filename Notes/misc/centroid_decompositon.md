# 树分治

树分治包括点分治/边分治和点分树，是分治思想在树上的应用。

## 点分治

设当前选中的根为 $u$，则所有树上的所有路径可以分类为：

- 经过 $u$ 的路径
  - 一端为 $u$ 的路径
  - 两端都不为 $u$ 的路径
- 不经过 $u$ 的路径（递归处理）

每次选择新的根后，都要重新计算一遍子树大小。

时间复杂度类似 $\text{CDQ}$ 分治，最多递归 $\log{n}$ 层。

## 边分治

## 点分树

点分树用来解决动态点分治问题，即带询问的点分治问题。

> [HNOI 2025 开店](https://www.acwing.com/problem/content/2228/)

每次询问树的结构都不变，所以我们可以使用点分治的方法预处理出每次递归中子树的重心，并将将这些重心建成一棵树，根节点为原树的重心，一个节点的子节点为按照点分治得到的下一层重心。我们将这种结构称之为点分树，即通过点分治得到的树。在得到点分树之后，我们不需要再反复的进行求重心的操作来处理询问，而只需要关心如何快速合并不同子树间的信息。

回到例题，对于每次询问，我们的分治策略是：

- 当$u$不是重心时，答案为与$u$不在同一子树中的点信息+$u$所在子树的答案
- 当$u$是重心时，答案为当前子树中所有点的信息，结束递归



https://ac.nowcoder.com/acm/contest/51727/C